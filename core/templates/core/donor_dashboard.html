{% extends "core/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">Donor Dashboard</h2>


    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            My Profile
        </div>
        <div class="card-body">
            {% if profile %}
            <p><strong>Name:</strong> {{ profile.user.get_full_name }}</p>
            <p><strong>Email:</strong> {{ profile.user.email }}</p>
            <p><strong>Phone:</strong> {{ profile.phone }}</p>
            <p><strong>City:</strong> {{ profile.city }}</p>
            <p><strong>Blood Group:</strong> {{ profile.blood_group }}</p>
            {% else %}
            <p>No profile information found.</p>
            {% endif %}
            <a href="{% url 'edit_profile' %}" class="btn btn-secondary btn-sm mt-2">Edit Profile</a>
        </div>
    </div>


    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            Available Blood Units
        </div>
        <div class="card-body">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Blood Group</th>
                        <th>Total Units</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in available %}
                    <tr>
                        <td>{{ item.blood_group }}</td>
                        <td>{{ item.total_units }}</td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="2">No inventory found.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>


    <div class="card mb-4">
        <div class="card-header bg-info text-white">
            My Donation History
        </div>
        <div class="card-body">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Blood Group</th>
                        <th>Units</th>
                        <th>Blood Bank</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in donation_history %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ record.blood_group }}</td>
                        <td>{{ record.units }}</td>
                        <td>
                            {% if record.blood_bank %}
                                {{ record.blood_bank.name }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>{{ record.donated_at|date:"d M Y H:i" }}</td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="5">No donation history found.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <a href="{% url 'make_request' %}" class="btn btn-warning">Make a Blood Request</a>
</div>
{% endblock %}
